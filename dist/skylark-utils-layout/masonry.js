/**
 * skylark-utils-layout - The dom layout features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/langx","skylark-utils/finder","skylark-utils/geom","skylark-utils/styler","./layouts"],function(t,i,o,a,n){var l=t.klass({_measureColumns:function(t,i,o){var a=this._,n=a.calculated;if(a.columnWidth)n.columnWidth=a.columnWidth;else{var l=t[0];n.columnWidth=l&&l.bounds().extraWidth()||i.width}var s,e=n.columnWidth+=a.gutter,u=i.width+a.gutter;if(a.cols)s=a.cols;else{var s=u/e,c=e-u%e,r=c&&c<1?"round":"floor";s=Math[r](s)}n.cols=Math.max(s,1)},_positionItem:function(t,i,n,l){a.css(t,{position:"absolute"}),l?o.relativePositionitem(t,{left:i,top:n}):t[this._.animation]?t[this._.animation](i,n):t.moveto(i,n)},_getColGroup:function(t){var i=this._,o=i.calculated;if(t<2)return o.colYs;for(var a=[],n=o.cols+1-t,l=0;l<n;l++){var s=o.colYs.slice(l,l+t);a[l]=Math.max.apply(Math,s)}return a},_getItemLayoutPosition:function(t){var i=this._,a=i.calculated,n=o.marginSize(t),l=n.width%a.columnWidth,s=l&&l<1?"round":"ceil",e=Math[s](n.width/a.columnWidth);e=Math.min(e,a.cols);for(var u=this._getColGroup(e),c=Math.min.apply(Math,u),r=u.indexOf(c),h={x:a.columnWidth*r,y:c},m=c+n.height,d=a.cols+1-u.length,f=0;f<d;f++)a.colYs[r+f]=m;return h},_filterItems:function(t){return t},_resetLayout:function(t,i,o){var a=this._,n=a.calculated;this._measureColumns(t,i,o),n.colYs=[];for(var l=0;l<n.cols;l++)n.colYs.push(0);n.maxY=0},_calcLayout:function(t,i,o){this._resetLayout(t,i,o);var a=[];return t.forEach(function(t){var i=this._getItemLayoutPosition(t);i.item=t,a.push(i)},this),a},_postLayout:function(t,i){var o=this._;if(o.autoFit){var a=o.calculated,n=Math.max.apply(Math,a.colYs);i.domNode.style.height=n+"px"}t.forEach(function(t){this._positionItem(t.item,t.x,t.y,t.isInstant)},this)},layout:function(){var t=this._,a=t.container,n=i.children(a,t.items),l=o.clientSize(a),s=this._calcLayout(n,l,a);this._postLayout(s,a)},init:function(i,o){var a=this._=t.mixin({autoFit:!0,columnWidth:0,cols:0,gutter:0,animation:"moveto",calculated:{colYs:null,columnWidth:0,cols:0}},o);a.container=i}}),s=n.masonry=function(t,i){var o=new l(t,i);o.layout()};return s});
//# sourceMappingURL=sourcemaps/masonry.js.map
